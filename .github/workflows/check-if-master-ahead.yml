name: Check-if-master-ahead
on: workflow_dispatch 
# on:
#     types: 
#       - requested
#   schedule:
# #     - cron: '0 8 * * 1-5'
#   CHANGELOG=$(cat test.md)
#   CHANGELOG="${CHANGELOG//'%'/'%25'}"
#   CHANGELOG="${CHANGELOG//$'\n'/'%0A'}"
#   CHANGELOG="${CHANGELOG//$'\r'/'%0D'}"
#   echo "::set-output name=changeLog::$CHANGELOG"
jobs:
  get_tag:
    runs-on: ubuntu-latest
    steps:
      - name: checkout
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
      - name: get latest git tag
        id: get_tag
        run: echo "TAG=$(git describe --abbrev=0 --tags)" >> $GITHUB_ENV
      - name: diff master and tag
        id: diff
        run: | 
          DIFF=$(git shortlog ${{env.TAG}}..master)
          DIFF="${DIFF//'%'/'%25'}"
          DIFF="${DIFF//$'\n'/'%0A'}"
          DIFF="${DIFF//$'\r'/'%0D'}"
          echo "::set-output name=diff::$DIFF"
      - name: output
        id: output
        run: echo ${{steps.diff.outputs.diff}}
